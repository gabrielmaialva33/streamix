"use strict";(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[961],{6072:(t,e,i)=>{i.d(e,{A:()=>s});var n=i(19371);class s{constructor(){(0,n.A)(this,"type",-1),(0,n.A)(this,"onStreamAdd",void 0)}async destroy(t){}}},64961:(t,e,i)=>{i.r(e),i.d(e,{default:()=>l});var n=i(19371),s=i(77389),r=i(6072),u=i(41863),h=i(47378),a=i(31184),c=i(1818),o=i(57102),d=i(17630),g=i(4068),f=i(87339);class l extends r.A{constructor(){super(),(0,n.A)(this,"type",19),(0,n.A)(this,"queue",void 0),(0,n.A)(this,"index",void 0)}init(t){this.queue=[]}async readChunk(t){let e="";const i=t.ioReader.getPos();for(;;){const i=await t.ioReader.readLine();if(""===i)break;e+=i+"\n"}return{chunk:e.trim(),pos:i}}async readHeader(t){const e=t.createStream();e.codecpar.codecId=94225,e.codecpar.codecType=3,e.timeBase.den=1e3,e.timeBase.num=1,this.index=0;let i=BigInt(0);try{for(;;){const{chunk:n,pos:s}=await this.readChunk(t);if(""===n)continue;const r=n.split("\n");let u=r.shift().trim(),h=r.shift().split(/--?>/);const a=o.t(h[0]),c=o.t(h[1]);if(c<=a)continue;const g=r.join("\n").trim();if(!g)continue;e.nbFrames++,e.duration=c;const f={identifier:u,context:g,startTs:a,endTs:c,pos:s};a>=i?(this.queue.push(f),i=a):d._(this.queue,f,(t=>t.startTs<f.startTs?1:-1))}}catch(t){return 0}}async readAVPacket(t,e){if(!this.queue.length)return h.LR;if(this.index>=this.queue.length)return-1048576;const i=t.streams.find((t=>3===t.codecpar.codecType)),n=this.queue[this.index++];if(s.M[15](e+32,i.index),s.M[15](e+76,i.timeBase.den),s.M[15](e+72,i.timeBase.num),s.M[17](e+16,n.startTs),s.M[17](e+8,n.startTs),s.M[17](e+48,n.endTs-n.startTs),n.identifier){const t=g.encode(n.identifier),i=(0,a.sY)(t.length);(0,u.lW)(i,t.length,t),(0,c.Ow)(e,16,i,t.length)}const r=g.encode(n.context),o=(0,a.sY)(r.length);return(0,u.lW)(o,r.length,r),(0,c.NX)(e,o,r.length),0}async seek(t,e,i,n){if(2&n)return BigInt(h.E$);if(i<=BigInt(0))return this.index=0,BigInt(0);const s=d.El(this.queue,(t=>t.startTs>i?-1:1));if(s>=0){for(f.Yz(`seek in cues, found index: ${s}, pts: ${this.queue[s].startTs}, pos: ${this.queue[s].pos}`,"packages/avformat/src/formats/ISubRipFormat.ts",215),this.index=Math.max(s-1,0);this.index>0&&(this.queue[this.index-1].startTs===this.queue[this.index].startTs||this.queue[this.index-1].endTs>i);)this.index--;return BigInt(0)}return BigInt(h.LR)}getAnalyzeStreamsCount(){return 1}}},57102:(t,e,i)=>{function n(t){if(!t)return-BigInt(1);let e=(t=t.trim()).split(":"),i=BigInt(0);if(3===e.length&&(i+=BigInt(+e.shift().trim())*BigInt(36e5)),i+=BigInt(+e.shift().trim())*BigInt(6e4),e=e.shift().trim().split("."),i+=BigInt(+e.shift().trim())*BigInt(1e3),e.length){let t=e[0].trim().length,n=BigInt(+e.shift().trim());1===t?n*=BigInt(100):2===t&&(n*=BigInt(10)),i+=n}return i}function s(t){if(!t)return-BigInt(1);let e=(t=t.trim()).split(":"),i=BigInt(0);if(3===e.length&&(i+=BigInt(+e.shift().trim())*BigInt(36e5)),i+=BigInt(+e.shift().trim())*BigInt(6e4),e=e.shift().trim().split(","),i+=BigInt(+e.shift().trim())*BigInt(1e3),e.length){let t=e[0].trim().length,n=BigInt(+e.shift().trim());1===t?n*=BigInt(100):2===t&&(n*=BigInt(10)),i+=n}return i}i.d(e,{j:()=>n,t:()=>s})}}]);