"use strict";(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[653],{6072:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(19371);class r{constructor(){(0,i.A)(this,"type",-1),(0,i.A)(this,"onStreamAdd",void 0)}async destroy(t){}}},12653:(t,e,n)=>{n.r(e),n.d(e,{default:()=>f});var i=n(19371),r=n(77389),a=n(6072),s=n(41863),o=n(31184),u=n(47378),c=n(1818),g=n(13277),l=n(4068),d=n(17630),h=n(87339);class f extends a.A{constructor(){super(),(0,i.A)(this,"type",21),(0,i.A)(this,"queue",void 0),(0,i.A)(this,"index",void 0)}init(t){this.queue=[]}async readHeader(t){const e=t.createStream();e.codecpar.codecId=94232,e.codecpar.codecType=3,e.timeBase.den=1e3,e.timeBase.num=1;let n="";if(1&t.ioReader.flags){const e=await t.ioReader.fileSize();n=await t.ioReader.readString(Number(BigInt.asIntN(32,e)))}else try{n+=await t.ioReader.readLine()+"\n"}catch(t){}if(l){const t=g.q(n);if(this.queue=t.queue,t.head){const n=JSON.stringify(t.head),i=l.encode(n);e.codecpar.extradata=(0,o.sY)(i.length),(0,s.lW)(e.codecpar.extradata,i.length,i),e.codecpar.extradataSize=i.length}}return this.index=0,0}async readAVPacket(t,e){if(!this.queue.length)return u.LR;if(this.index>=this.queue.length)return-1048576;const n=t.streams.find((t=>3===t.codecpar.codecType)),i=this.queue[this.index++];r.M[15](e+32,n.index),r.M[15](e+76,n.timeBase.den),r.M[15](e+72,n.timeBase.num),r.M[17](e+16,i.pts),r.M[17](e+8,i.pts),r.M[17](e+48,i.duration);const a=l.encode(i.context),g=(0,o.sY)(a.length);return(0,s.lW)(g,a.length,a),(0,c.NX)(e,g,a.length),0}async seek(t,e,n,i){if(2&i)return BigInt(u.E$);if(n<=BigInt(0))return this.index=0,BigInt(0);const r=d.El(this.queue,(t=>t.pts>n?-1:1));if(r>=0){for(h.Yz(`seek in cues, found index: ${r}, pts: ${this.queue[r].pts}`,"packages/avformat/src/formats/ITtmlFormat.ts",158),this.index=Math.max(r-1,0);this.index>0&&(this.queue[this.index-1].pts===this.queue[this.index].pts||this.queue[this.index-1].pts+this.queue[this.index-1].duration>n);)this.index--;return BigInt(0)}return BigInt(u.LR)}getAnalyzeStreamsCount(){return 1}}},13277:(t,e,n)=>{n.d(e,{q:()=>o});var i=n(79880),r=n(17630),a=n(81819),s=n(57102);function o(t){const e=(0,i.A)(t,{aloneValueName:"context"});if(!e.tt)return{queue:[],head:{}};const n=[];function o(t){let e="";return r.__(t,(t=>{a.Yj(t)?e+=t:t.context?e+=`<${t.tagName}>${t.context}</${t.tagName}>`:e+=`<${t.tagName}/>`})),e}function u(t,e,i){let u=s.j(e||t.begin),c=t.context||"",g=t.region||"Default",l="";a.YO(c)&&(c=o(c)),a.YO(t.span)?r.__(t.span,(t=>{t.context&&(u===-BigInt(1)&&t.begin&&(u=s.j(t.begin)),!g&&t.region&&(g=t.region),a.Yj(t.context)?(c+=t.context,t.br&&(c+="<br>")):(c+=o(t.context),t.br&&(c+="<br>"))),t.end&&(l=t.end)})):t.span&&(t.span.context&&(u===-BigInt(1)&&t.span.begin&&(u=s.j(t.span.begin)),!g&&t.span.region&&(g=t.span.region),a.Yj(t.span.context)?c+=t.span.context:c+=o(t.span.context)),t.span.end&&(l=t.span.end)),n.push({context:c,pts:u,region:g,duration:t.dur?s.j(t.dur):s.j(i||t.end||l)-u})}function c(t,e,n){a.YO(t)?r.__(t,(t=>{u(t,e,n)})):u(t,e,n)}return e.tt.body&&e.tt.body.div&&(a.YO(e.tt.body.div)?r.__(e.tt.body.div,(t=>{t.p&&c(t.p,t.begin,t.end)})):e.tt.body.div.p&&c(e.tt.body.div.p,e.tt.body.div.begin,e.tt.body.end)),{queue:n,head:e.tt.head||{}}}},57102:(t,e,n)=>{function i(t){if(!t)return-BigInt(1);let e=(t=t.trim()).split(":"),n=BigInt(0);if(3===e.length&&(n+=BigInt(+e.shift().trim())*BigInt(36e5)),n+=BigInt(+e.shift().trim())*BigInt(6e4),e=e.shift().trim().split("."),n+=BigInt(+e.shift().trim())*BigInt(1e3),e.length){let t=e[0].trim().length,i=BigInt(+e.shift().trim());1===t?i*=BigInt(100):2===t&&(i*=BigInt(10)),n+=i}return n}function r(t){if(!t)return-BigInt(1);let e=(t=t.trim()).split(":"),n=BigInt(0);if(3===e.length&&(n+=BigInt(+e.shift().trim())*BigInt(36e5)),n+=BigInt(+e.shift().trim())*BigInt(6e4),e=e.shift().trim().split(","),n+=BigInt(+e.shift().trim())*BigInt(1e3),e.length){let t=e[0].trim().length,i=BigInt(+e.shift().trim());1===t?i*=BigInt(100):2===t&&(i*=BigInt(10)),n+=i}return n}n.d(e,{j:()=>i,t:()=>r})},79880:(t,e,n)=>{n.d(e,{A:()=>s});var i=n(17630);const r={aloneValueName:"_@attribute"},a=[" ","/",'"',"'","<",">"];function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;t=(t=(t=(t=t.replace(/<!--[\s\S]*?-->/g,"")).replace(/[\n\t\r]/g,"")).replace(/>[ \t]+</g,"><")).replace(/<\?[^>]*\?>/g,"");const n=[];let s=0;function o(t,i){const r=n[n.length-1];r&&(t!==e.aloneValueName||null==r.obj[e.aloneValueName]?null==r.obj[t]?r.obj[t]=i:Array.isArray(r.obj[t])?r.obj[t].push(i):r.obj[t]=[r.obj[t],i]:r.obj[e.aloneValueName]=[r.obj[e.aloneValueName],{tagName:t,...i}])}function u(e){for(;s<t.length;){if(t[s]===e)return!0;s++}return!1}function c(){g();let e="";for(;s<t.length&&!i.zy(a,t[s]);)e+=t[s],s++;return e}function g(){for(;s<t.length&&/\s|\r|\n/.test(t[s]);)s++}const l=/\s/,d=/'/,h=/"/;function f(){if(s>=t.length)return!0;g();let e=l;'"'!==t[s]&&"'"!=t[s]||(e='"'===t[s]?h:d,s++);let n="";for(;s<t.length;){if(e.test(t[s])){s++;break}n+=t[s],s++}return n}function p(){g();let e="";for(;s<t.length&&"<"!==t[s];)e+=t[s],s++;return e}function m(){for(;"<"===t[s];){const e=s;if(s++,g(),"/"!==t[s]){s=e;break}if(s++,c()===n[n.length-1].tag){if(n.length>1){const t=n.pop();o(t.tag,t.obj)}u(">"),s++,g()}else n.pop(),u(">"),s++,g()}}return function i(){if(s>=t.length)return;let r=s;if(g(),"<"!==t[s])return s=r,o(e.aloneValueName,p()),m(),i();let a=u("<");if(!a)return;r=s,s++;const l=c();if(n.push({obj:{},tag:l,start:r}),function(){for(;g(),">"!==t[s]&&"/"!==t[s];){let t=c();if(!t)break;"="===t[t.length-1]?t=t.substring(0,t.length-1):(u("="),s++),o(t,f())}}(),g(),"/"===t[s]){if(s++,n.length>1){const t=n.pop();o(t.tag,t.obj)}return u(">"),s++,m(),i()}a=u(">"),a&&(s++,g(),"<"!==t[s]&&(o(e.aloneValueName,p()),g()),m(),i())}(),{[n[0].tag]:n[0].obj}}}}]);